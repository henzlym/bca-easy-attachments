(()=>{"use strict";const e=window.wp.element,t=(window.wp.keycodes,window.wp.components),n=window.wp.editPost,a=window.wp.data,l=(window.wp.coreData,window.wp.editor),{G:o,Path:s,SVG:r,Polygon:c}=wp.components,i=()=>(0,e.createElement)(r,{version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 512 512"},(0,e.createElement)(o,null,(0,e.createElement)(s,{d:"m414.996 55.632-133.445 96.954 223.595 162.453c4.474-18.923 6.854-38.646 6.854-58.916 0-81.129-37.942-153.555-97.004-200.491z"}),(0,e.createElement)(s,{d:"m388.984 37.449c-38.782-23.673-84.318-37.327-132.984-37.327-52.302 0-100.982 15.778-141.555 42.807l50.996 156.936z"}),(0,e.createElement)(s,{d:"m89.141 62.132c-54.546 46.983-89.141 116.52-89.141 193.99 0 23.805 3.278 46.856 9.385 68.739h165.129z"}),(0,e.createElement)(s,{d:"m19.817 354.862c37.401 89.128 123.835 152.773 225.365 157.016l51.017-157.016z"}),(0,e.createElement)(s,{d:"m276.925 511.262c100.648-8.181 185.011-74.829 218.996-165.845l-133.577-97.05z"}))),d=function(n){console.log(n);const{onChange:a,results:l,value:o}=n;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.SearchControl,{className:"easy-attachments-sidebar_search-container",value:o,onChange:a}),l())},{G:m,Path:u,SVG:p,Polygon:h}=wp.components,w=()=>(0,e.createElement)(p,{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/SVG",x:"0px",y:"0px",viewBox:"0 0 512 512"},(0,e.createElement)(m,null,(0,e.createElement)(m,null,(0,e.createElement)(h,{stroke:"green","stroke-width":"1px",points:"0,0 0,173.419 49.548,173.419 49.548,49.548 173.419,49.548 173.419,0 \t\t"}))),(0,e.createElement)(m,null,(0,e.createElement)(m,null,(0,e.createElement)(h,{points:"338.581,0 338.581,49.548 462.452,49.548 462.452,173.419 512,173.419 512,0 \t\t"}))),(0,e.createElement)(m,null,(0,e.createElement)(m,null,(0,e.createElement)(h,{points:"462.452,338.581 462.452,462.452 338.581,462.452 338.581,512 512,512 512,338.581 \t\t"}))),(0,e.createElement)(m,null,(0,e.createElement)(m,null,(0,e.createElement)(h,{points:"49.548,462.452 49.548,338.581 0,338.581 0,512 173.419,512 173.419,462.452 \t\t"}))),(0,e.createElement)(m,null,(0,e.createElement)(m,null,(0,e.createElement)(h,{points:"280.774,231.226 280.774,140.387 231.226,140.387 231.226,231.226 140.387,231.226 140.387,280.774  231.226,280.774 231.226,371.613 280.774,371.613 280.774,280.774 371.613,280.774 371.613,231.226 \t\t"})))),{G:E,Path:g,SVG:y,Polygon:b}=wp.components,v=()=>(0,e.createElement)(y,{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 512 512"},(0,e.createElement)(E,null,(0,e.createElement)(E,null,(0,e.createElement)(g,{d:"M0,62.061v387.879h512V62.061H0z M465.455,403.394H46.545V108.606h418.909V403.394z"}))),(0,e.createElement)(E,null,(0,e.createElement)(E,null,(0,e.createElement)(b,{points:"364.606,223.088 302.545,285.148 193.939,176.542 93.091,277.391 93.091,356.849 418.909,356.849  418.909,277.391 \t\t"}))),(0,e.createElement)(E,null,(0,e.createElement)(E,null,(0,e.createElement)(g,{d:"M310.303,155.152c-17.11,0-31.03,13.92-31.03,31.03s13.92,31.03,31.03,31.03s31.03-13.92,31.03-31.03 S327.413,155.152,310.303,155.152z"})))),{G:f,Path:C,SVG:x,Polygon:P}=wp.components,_=()=>(0,e.createElement)(x,{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 512 512"},(0,e.createElement)(f,null,(0,e.createElement)(f,null,(0,e.createElement)(P,{points:"280.774,243.833 280.774,12.387 231.226,12.387 231.226,243.833 135.612,243.833 255.99,364.181 376.396,243.833  "}))),(0,e.createElement)(f,null,(0,e.createElement)(f,null,(0,e.createElement)(P,{points:"462.452,243.613 462.452,450.065 49.548,450.065 49.548,243.613 0,243.613 0,499.613 512,499.613 512,243.613 \t\t "})))),{Fragment:D,Component:S}=wp.element;class N extends S{constructor(e){super(...arguments),this.props=e,this.state={hover:!1,imageClass:"",buttonContainerClass:"",buttonClass:"",intoPostButtonClass:"",featuredButtonClass:""}}render(){const{photo:{id:t,height:n,width:a,user:{username:l,profile_image:o},description:s,urls:r,links:{download_location:c}},download:i,isDownloading:d,isDownloaded:m}=this.props;let u=d==t?" downloading":"",p=m==t?" downloaded":"";return(0,e.createElement)("div",{id:`photo-${t}`,className:`easy-attachments-sidebar_photo_container${u}${p}`,onMouseLeave:()=>{this.setState({buttonClass:"",featuredButtonClass:"",intoPostButtonClass:"",buttonContainerClass:""})}},(0,e.createElement)("div",{className:"easy-attachments-sidebar_photo_user"},(0,e.createElement)("img",{src:o.large,alt:""}),(0,e.createElement)("span",null,l)),(0,e.createElement)("img",{height:n,width:a,src:r.regular,alt:s,srcset:""}),(0,e.createElement)("div",{className:"easy-attachments-download_container"},(0,e.createElement)("button",{title:"Download into post",className:`download_intopost${this.state.intoPostButtonClass}`,onClick:e=>{i(this.props.photo,"in-post")}},(0,e.createElement)(w,null)),(0,e.createElement)("button",{title:"Set as featured image",className:`download_featured${this.state.featuredButtonClass}`,onClick:e=>{i(this.props.photo,"featured-image")}},(0,e.createElement)(v,null)),(0,e.createElement)("button",{title:"Download to media library",className:`download${this.state.featuredButtonClass}`,onClick:e=>{i(this.props.photo)}},(0,e.createElement)(_,null))),(0,e.createElement)("div",{className:"easy-attachments-download_container_overlay"},(0,e.createElement)("span",null," downloading"==u?"Downloading":"Downloaded"),(0,e.createElement)("div",{className:"linePreloader"})))}}const B=function(){const[t,o]=(0,e.useState)({baseURI:"https://api.unsplash.com/",path:"photos",categories:[],images:[],isDownloading:!1,isDownloaded:!1,options:{headers:{Authorization:"Client-ID bf623eb6ee39cc322bb85c8e4575cda12670ee12cbfd85376bac4a022400edde"}},searchTerm:""}),{baseURI:s,images:r,isDownloaded:c,isDownloading:m,options:u,path:p,searchTerm:h}=t,w=s+p,{data:E}=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[a,l]=(0,e.useState)(null),[o,s]=(0,e.useState)(null),[r,c]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{let e=!0;return fetch(t,n).then((e=>e.json())).then((t=>{e&&(l(t),s(null))})).catch((t=>{e&&(s(t),l(null))})).finally((()=>e&&c(!1))),()=>e=!1}),[t,n]),{data:a,error:o,isLoading:r}}(w,u);console.log(E);const g=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";fetch(s+`photos/${e.id}/download`,u).then((e=>e.json())).then((s=>{if(s){const s=(0,a.select)(l.store).getCurrentPostId();o({...t,isDownloading:e.id}),fetch("/wp-json/easy-attachments/v1/download",{method:"POST",body:JSON.stringify({post_id:s,photo:e,download_link:e.urls.full}),headers:{"X-WP-Nonce":blkcanvasGlobal.nonce,Accept:"application/json","Content-Type":"application/json"}}).then((e=>e.json())).then((a=>{if(a){if("in-post"==n){let e=wp.blocks.createBlock("core/image",{id:a.id,url:a.url,alt:a.alt,caption:a.caption});wp.data.dispatch("core/editor").insertBlocks(e)}"featured-image"==n&&wp.data.dispatch("core/editor").editPost({featured_media:a.id}),o({...t,isDownloaded:e.id,isDownloading:!1})}else wp.data.dispatch("core/notices").createNotice("error",a.msg,{isDismissible:!0})}))}}))};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(n.PluginSidebarMoreMenuItem,{target:"easy-attachments"},"My Sidebar"),(0,e.createElement)(n.PluginSidebar,{name:"easy-attachments",title:"Easy Attachments",icon:(0,e.createElement)(i,null)},(0,e.createElement)("div",{className:"easy-attachments-sidebar"},(0,e.createElement)(d,{results:()=>null==E||0==E.length?null:(0,e.createElement)("div",{className:"easy-attachments-sidebar_photos"},E.map(((t,n)=>(0,e.createElement)(N,{isDownloading:m,isDownloaded:c,photo:t,download:g})))),value:h,onChange:e=>{o({...t,searchTerm:e})}}))))},{registerPlugin:k}=wp.plugins;k("easy-attachments-sidebar",{render:function(){return(0,e.createElement)(B,null)}})})();